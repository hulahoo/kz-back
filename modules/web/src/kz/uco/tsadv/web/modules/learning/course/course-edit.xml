<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/screen/window.xsd"
        caption="msg://Course.editorCaption"
        focusComponent="fieldGroup"
        messagesPack="kz.uco.tsadv.web.modules.learning.course">
    <data>
        <instance id="courseDc"
                  class="kz.uco.tsadv.modules.learning.model.Course"
                  view="course.edit.new">
            <collection id="sectionsDc"
                        property="sections">
                <collection id="sessionsDc"
                            property="session"/>
            </collection>
            <collection id="competencesDc"
                        property="competences"/>
            <collection id="preRequisitionDc"
                        property="preRequisition"/>
            <collection id="feedbackTemplatesDc"
                        property="feedbackTemplates"/>
            <collection id="courseScheduleDc"
                        property="courseSchedule"/>
            <collection id="trainerDc"
                        property="courseTrainers"/>
            <loader id="courseDl"/>
        </instance>
        <collection id="dicLearningTypesDc"
                    class="kz.uco.tsadv.modules.learning.dictionary.DicLearningType"
                    view="_minimal">
            <loader id="dicLearningTypesDl">
                <query>
                    <![CDATA[select e from tsadv$DicLearningType e]]>
                </query>
            </loader>
        </collection>
        <collection id="enrollmentDc"
                    class="kz.uco.tsadv.modules.learning.model.Enrollment"
                    view="enrollment.for.course">
            <loader id="enrollmentDl">
                <query>
                    <![CDATA[select e from tsadv$Enrollment e where e.course = :course]]>
                </query>
            </loader>
        </collection>
    </data>
    <dialogMode height="600"
                width="800"/>
    <layout expand="tabSheet"
            spacing="true">
        <tabSheet id="tabSheet">
            <tab id="mainInfo"
                 caption="msg://mainInfo"
                 margin="true,true,true,false">
                <scrollBox id="scrollBox"
                           height="100%"
                           spacing="true">
                    <hbox margin="false,false,true,false">
                        <label value="mainMsg://Logo"
                               width="100px"/>
                        <embedded id="courseImage"
                                  align="MIDDLE_CENTER"
                                  height="100px"
                                  stylename="b-user-image-edit"
                                  width="100px"/>
                        <upload id="imageUpload"
                                accept="*.jpg,*.png"
                                align="MIDDLE_CENTER"
                                clearButtonIcon="icons/item-remove.png"
                                fileSizeLimit="1024000"
                                showClearButton="true"
                                uploadButtonIcon="icons/reports-template-upload.png"/>
                    </hbox>
                    <form id="fieldGroup"
                          dataContainer="courseDc">
                        <column width="250px">
                            <textField id="name" property="name"/>
                            <pickerField property="party">
                                <actions>
                                    <action id="lookup" type="picker_lookup"/>
                                    <action id="clear" type="picker_clear"/>
                                </actions>
                            </pickerField>
                            <pickerField property="category">
                                <actions>
                                    <action id="lookup" type="picker_lookup"/>
                                    <action id="clear" type="picker_clear"/>
                                </actions>
                            </pickerField>
                            <textField property="targetAudience"/>
                            <lookupField caption="msg://learningType"
                                         optionsContainer="dicLearningTypesDc"
                                         property="learningType"/>
                            <checkBox property="activeFlag"/>
                            <checkBox property="selfEnrollment"/>
                            <checkBox property="isOnline"/>
                            <textArea id="shortDescription" property="shortDescription"
                                      rows="5"/>
                        </column>
                    </form>
                </scrollBox>
            </tab>
            <tab id="courseSchedule" caption="msg://courseSchedule"
                 margin="true, false, false, false">
                <table id="courseScheduleTable" height="100%" width="100%" dataContainer="courseScheduleDc">
                    <actions>
                        <action id="create" type="create"/>
                        <action id="edit" type="edit"/>
                        <action id="remove" type="remove"/>
                    </actions>
                    <columns>
                        <column id="name"/>
                        <column id="startDate"/>
                        <column id="endDate"/>
                        <column id="learningCenter"/>
                        <column id="address"/>
                        <column id="maxNumberOfPeople"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="courseScheduleBtnPanel">
                        <button id="courseScheduleCreate" action="courseScheduleTable.create"/>
                        <button id="courseScheduleEdit" action="courseScheduleTable.edit"/>
                        <button id="courseScheduleRemove" action="courseScheduleTable.remove"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="sections"
                 caption="msg://Course.sections"
                 margin="true,true,true,false">
                <table id="sectionsTable"
                       dataContainer="sectionsDc"
                       height="100%"
                       width="100%">
                    <actions>
                        <action id="create"
                                caption="mainMsg://table.btn.empty"
                                type="create"
                                icon="icons/plus-btn.png"/>
                        <action id="edit"
                                type="edit"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="excel"
                                type="excel"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/excel.png"/>
                    </actions>
                    <columns>
                        <column id="sectionName"/>
                        <column id="format.langValue"
                                caption="msg://CourseSection.format"/>
                        <column id="order"/>
                        <column id="mandatory"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="sectionButtonsPanel"
                                  alwaysVisible="true">
                        <button action="sectionsTable.create"/>
                        <button action="sectionsTable.edit"/>
                        <button action="sectionsTable.remove"/>
                        <button action="sectionsTable.excel"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="preRequisitions"
                 caption="msg://Course.preRequisition"
                 margin="true,true,true,false">
                <table id="preRequisitionTable"
                       dataContainer="preRequisitionDc"
                       height="100%"
                       width="100%">
                    <actions>
                        <action id="selectPreRequisition"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="excel"
                                type="excel"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/excel.png"/>
                    </actions>
                    <columns>
                        <column id="requisitionCourse.name"/>
                        <column id="requisitionCourse.category.langValue"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="preRequisitionButtonsPanel">
                        <button action="preRequisitionTable.selectPreRequisition"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/plus-btn.png"/>
                        <button action="preRequisitionTable.remove"/>
                        <button action="preRequisitionTable.excel"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="competences"
                 caption="msg://Course.competences"
                 margin="true,true,true,false">
                <table id="competencesTable"
                       dataContainer="competencesDc"
                       height="100%"
                       width="100%">
                    <actions>
                        <action id="create"
                                type="create"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/plus-btn.png"/>
                        <action id="edit"
                                type="edit"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="excel"
                                type="excel"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/excel.png"/>
                    </actions>
                    <columns>
                        <column id="competenceGroup.competence.competenceName"/>
                        <column id="scaleLevel"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="competenceButtonsPanel">
                        <button action="competencesTable.create"/>
                        <button action="competencesTable.edit"/>
                        <button action="competencesTable.remove"/>
                        <button action="competencesTable.excel"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="description"
                 caption="msg://Course.description"
                 margin="true,true,true,false">
                <richTextArea id="richTextArea"
                              dataContainer="courseDc"
                              height="100%"
                              property="description"
                              width="100%"/>
            </tab>
            <tab id="templates"
                 caption="msg://kz.uco.tsadv.modules.learning.model/Course.feedbackTemplates"
                 expand="feedbackTemplatesTable"
                 margin="true,true,true,false">
                <table id="feedbackTemplatesTable"
                       dataContainer="feedbackTemplatesDc"
                       width="100%">
                    <actions>
                        <action id="create"
                                type="create"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/plus-btn.png"/>
                        <action id="edit"
                                type="edit"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                    </actions>
                    <columns>
                        <column id="feedbackTemplate.name"/>
                        <column id="startDate"/>
                        <column id="endDate"/>
                    </columns>
                    <rows/>
                    <rowsCount/>
                    <buttonsPanel>
                        <button action="feedbackTemplatesTable.create"/>
                        <button action="feedbackTemplatesTable.edit"/>
                        <button action="feedbackTemplatesTable.remove"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="enrollments"
                 caption="msg://kz.uco.tsadv.modules.learning.model/Course.enrollments"
                 spacing="true"
                 expand="enrollmentsTable"
                 margin="true,false,false,false">
                <filter id="filter"
                        applyTo="enrollmentsTable"
                        dataLoader="enrollmentDl">
                    <properties include=".*"/>
                </filter>
                <dataGrid id="enrollmentsTable"
                          selectionMode="MULTI_CHECK"
                          height="100%"
                          dataContainer="enrollmentDc"
                          width="100%">
                    <actions>
                        <action id="create"
                                type="create"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/plus-btn.png"/>
                        <action id="edit"
                                type="edit"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                    </actions>
                    <columns>
                        <column property="personGroup"/>
                        <column property="personGroup.currentAssignment.organizationGroup.organization.organizationName"
                                caption="mainMsg://organizationName"/>
                        <column property="personGroup.currentAssignment.positionGroup"/>
                        <column property="personGroup.currentAssignment.jobGroup"/>
                        <column property="personGroup.currentAssignment.gradeGroup"/>
                        <column property="courseSchedule"/>
                    </columns>
                    <rowsCount/>
                    <buttonsPanel>
                        <button action="enrollmentsTable.create"/>
                        <button action="enrollmentsTable.edit"/>
                        <button action="enrollmentsTable.remove"/>
                    </buttonsPanel>
                </dataGrid>
            </tab>
            <tab id="trainers"
                 caption="msg://kz.uco.tsadv.modules.learning.model/CourseSectionSession.trainer"
                 expand="trainersTable"
                 margin="true,true,true,false">
                <table id="trainersTable"
                       dataContainer="trainerDc"
                       width="100%">
                    <actions>
                        <action id="create"
                                type="create"
                                caption="mainMsg://table.btn.empty"
                                icon="icons/plus-btn.png"/>
                        <action id="edit"
                                type="edit"
                                caption="mainMsg://table.btn.empty"/>
                        <action id="remove"
                                type="remove"
                                caption="mainMsg://table.btn.empty"/>
                    </actions>
                    <columns>
                        <column id="trainer.employee" caption="msg://menu-config.tsadv$Trainer.browse"/>
                        <column id="dateFrom"/>
                        <column id="dateTo"/>
                    </columns>
                    <rows/>
                    <rowsCount/>
                    <buttonsPanel>
                        <button action="trainersTable.create"/>
                        <button action="trainersTable.edit"/>
                        <button action="trainersTable.remove"/>
                    </buttonsPanel>
                </table>
            </tab>
        </tabSheet>
        <hbox id="windowActions" spacing="true" width="AUTO">
            <button action="windowCommitAndClose"/>
            <button action="windowClose"/>
        </hbox>
    </layout>
</window>
