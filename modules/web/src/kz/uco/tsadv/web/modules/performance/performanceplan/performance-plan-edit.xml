<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        caption="msg://editorCaption"
        class="kz.uco.tsadv.web.modules.performance.performanceplan.PerformancePlanEdit"
        datasource="performancePlanDs"
        focusComponent="fieldGroup">
    <dsContext>
        <datasource id="performancePlanDs"
                    class="kz.uco.tsadv.modules.performance.model.PerformancePlan"
                    view="performancePlan.edit">
            <collectionDatasource id="organizationsDs"
                                  property="organizations"/>
            <collectionDatasource id="positionsDs"
                                  property="positions"/>
            <collectionDatasource id="jobsDs"
                                  property="jobs"/>
        </datasource>
        <collectionDatasource id="organizationGroupsDs"
                              class="kz.uco.tsadv.modules.personal.group.OrganizationGroupExt"
                              view="organizationGroup.browse">
            <query>
                <![CDATA[select e from base$OrganizationGroupExt e]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="positionGroupsDs"
                              class="kz.uco.tsadv.modules.personal.group.PositionGroupExt"
                              view="positionGroup.browse">
            <query>
                <![CDATA[select e from base$PositionGroupExt e]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="JobGroupsDs"
                              class="kz.uco.tsadv.modules.personal.group.JobGroup"
                              view="jobGroup.browse">
            <query>
                <![CDATA[select e from tsadv$JobGroup e]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="assignedPerformancePlansDs"
                              class="kz.uco.tsadv.modules.performance.model.AssignedPerformancePlan"
                              view="assignedPerformancePlan.browse">
            <query>
                <![CDATA[select e from tsadv$AssignedPerformancePlan e
                          where e.performancePlan.id = :ds$performancePlanDs.id]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="instructionKpiDs"
                              class="kz.uco.tsadv.modules.performance.model.InstructionsKpi"
                              view="instructionsKpi.edit">
            <query>
                <![CDATA[select e from tsadv_InstructionsKpi e
                          where e.performancePlan.id = :ds$performancePlanDs.id]]>
            </query>
        </collectionDatasource>
    </dsContext>
    <dialogMode height="600"
                width="800"/>
    <layout expand="tabSheet"
            spacing="true">
        <tabSheet id="tabSheet">
            <tab id="mainInfo"
                 caption="msg://mainInfo"
                 margin="true,false,false,false"
                 spacing="true">
                <fieldGroup id="fieldGroup"
                            datasource="performancePlanDs">
                    <column width="250px">
                        <field id="performancePlanName" property="performancePlanName"/>
                        <field id="description" property="description"/>
                        <field id="administratorPersonGroup" captionProperty="personFioWithEmployeeNumber"
                               property="administratorPersonGroup"/>
                        <field id="startDate" property="startDate"/>
                        <field id="endDate" property="endDate"/>
                        <field id="accessibilityStartDate" property="accessibilityStartDate" required="true"/>
                        <field id="accessibilityEndDate" property="accessibilityEndDate" required="true"/>
                    </column>
                </fieldGroup>
            </tab>
            <tab id="assignedPerformancePlan" caption="msg://assignedPerformancePlan"
                 margin="true, false, false, false"
                 spacing="true">
                <table id="assignedPerformancePlanTable" width="100%" height="100%">
                    <actions>
                        <action id="create" type="create"/>
                        <action id="edit" type="edit"/>
                        <action id="remove" type="remove"/>
                    </actions>
                    <columns>
                        <column id="assignedPerson"/>
                        <column id="assignedPerson.currentAssignment.organizationGroup"/>
                        <column id="result"/>
                        <column id="gzp"/>
                        <column id="assignedPerson.currentAssignment.positionGroup"/>
                        <column id="assignedPerson.currentAssignment.jobGroup"/>
                        <column id="assignedPerson.currentAssignment.gradeGroup"/>
                        <column id="assigned_by"/>
                        <column id="status"/>
                    </columns>
                    <rows datasource="assignedPerformancePlansDs"/>
                    <buttonsPanel id="assignedPerformancePlanBtnPnl">
                        <button id="assignedCreate" action="assignedPerformancePlanTable.create"/>
                        <button id="assignedEdit" action="assignedPerformancePlanTable.edit"/>
                        <button id="assignedRemove" action="assignedPerformancePlanTable.remove"/>
                    </buttonsPanel>
                </table>
            </tab>
            <tab id="instruction" spacing="true" margin="true, false, false, false"
                 caption="msg://instruction">
                <table id="instructionTable" width="100%" height="100%">
                    <actions>
                        <action id="create" type="create"/>
                        <action id="edit" type="edit"/>
                        <action id="remove" type="remove"/>
                    </actions>
                    <columns>
                        <column id="instruction"/>
                    </columns>
                    <rows datasource="instructionKpiDs"/>
                    <buttonsPanel id="instructionBtnPnl">
                        <button id="instructionCreate" action="instructionTable.create"/>
                        <button id="instructionEdit" action="instructionTable.edit"/>
                        <button id="instructionRemove" action="instructionTable.remove"/>
                    </buttonsPanel>
                </table>
            </tab>
            <!--            <tab id="profileOfApplicability"-->
            <!--                 caption="msg://profileOfApplicability"-->
            <!--                 margin="true,false,false,false"-->
            <!--                 spacing="true">-->
            <!--                <hbox height="100%"-->
            <!--                      spacing="true"-->
            <!--                      width="100%">-->
            <!--                    <groupBox caption="msg://OrganizationGroup.browseCaption"-->
            <!--                              height="100%"-->
            <!--                              spacing="true">-->
            <!--                        <tokenList id="tokenList"-->
            <!--                                   captionProperty="organization.organizationName"-->
            <!--                                   datasource="organizationsDs">-->
            <!--                            <lookup captionProperty="organization.organizationName"-->
            <!--                                    optionsDatasource="organizationGroupsDs"/>-->
            <!--                        </tokenList>-->
            <!--                    </groupBox>-->
            <!--                    <groupBox caption="msg://Position.browseCaption"-->
            <!--                              height="100%"-->
            <!--                              spacing="true">-->
            <!--                        <tokenList id="positionsTokenList"-->
            <!--                                   captionProperty="position.positionName"-->
            <!--                                   datasource="positionsDs">-->
            <!--                            <lookup captionProperty="position.positionName"-->
            <!--                                    optionsDatasource="positionGroupsDs"/>-->
            <!--                        </tokenList>-->
            <!--                    </groupBox>-->
            <!--                    <groupBox caption="msg://Job.browseCaption"-->
            <!--                              height="100%"-->
            <!--                              spacing="true">-->
            <!--                        <tokenList id="jobsTokenList"-->
            <!--                                   captionProperty="job.jobName"-->
            <!--                                   datasource="jobsDs">-->
            <!--                            <lookup captionProperty="job.jobName"-->
            <!--                                    optionsDatasource="JobGroupsDs"/>-->
            <!--                        </tokenList>-->
            <!--                    </groupBox>-->
            <!--                </hbox>-->
            <!--            </tab>-->
        </tabSheet>
        <frame id="windowActions"
               screen="editWindowActions"/>
    </layout>
</window>
